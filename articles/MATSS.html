<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MATSS: Getting Started • MATSS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MATSS: Getting Started">
<meta property="og:description" content="MATSS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MATSS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MATSS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-formats.html">Data Formats</a>
    </li>
    <li>
      <a href="../articles/dataset-summary.html">Dataset Summaries</a>
    </li>
    <li>
      <a href="../articles/hipergator-install.html">Installing MATSS on the HiPerGator</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/weecology/MATSS/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MATSS: Getting Started</h1>
                        <h4 class="author">Hao Ye</h4>
            
            <h4 class="date">2020-04-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/weecology/MATSS/blob/master/vignettes/MATSS.Rmd"><code>vignettes/MATSS.Rmd</code></a></small>
      <div class="hidden name"><code>MATSS.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><strong><code>MATSS</code></strong> is a package for conducting Macroecological Analyses of Time Series Structure. We designed it to help researchers quickly get started in analyses of ecological time series, and to reinforce and spread good practices in computational analyses.</p>
<p>We provide functionality to:</p>
<ul>
<li>obtain time series data from ecological communities, processed into a common <a href="data-formats.html">data format</a>
</li>
<li>perform basic processing and summaries of those datasets; see <a href="data-processing.html">data processing</a>
</li>
<li>build an analysis pipeline for macroecological analyses, using the workflow framework of the <code>drake</code> package</li>
<li>package the above data analytical work in a reproducible way in a <a href="#example-research-compendium">research compendium</a>
</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install <strong><code>MATSS</code></strong> from github with:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"># install.packages("remotes")
remotes::install_github("weecology/MATSS", build_opts = c("--no-resave-data", "--no-manual")))</pre></body></html></div>
<p>And load the package in the typical fashion:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">MATSS</span>)</pre></body></html></div>
</div>
</div>
<div id="example-research-compendium" class="section level1">
<h1 class="hasAnchor">
<a href="#example-research-compendium" class="anchor"></a>Example Research Compendium</h1>
<p>One of the best ways to get started is to create a research compendium. An auto-updating example is visible at <a href="https://github.com/weecology/MATSSdemo" class="uri">https://github.com/weecology/MATSSdemo</a></p>
<p>To get started, identify the location and name for your compendium. For example, <code>~/MATSSdemo</code> will put the compendium inside your home directory (the <code>~</code> location), with the package name <code>"MATSSdemo"</code>. (Note that package names can only contain ASCII letters, numbers, and “.” and have to start with a letter.)</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/create_MATSS_compendium.html">create_MATSS_compendium</a></span>(<span class="st">"&lt;path&gt;"</span>)</pre></body></html></div>
<div id="compendium-creation-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#compendium-creation-steps" class="anchor"></a>Compendium Creation Steps</h2>
<p>Running this code will perform the following operations:</p>
<ul>
<li>create a new R package for the analysis</li>
<li>add required dependencies for the new R package to its <code>DESCRIPTION</code> file</li>
<li>create an <code>analysis</code> folder to hold the analysis files
<ul>
<li>create a script to define and run the analysis</li>
<li>create an Rmarkdown report to plot the results of the analysis</li>
<li>create a <code>.bib</code> file to hold the MATSS reference linked to in the Rmarkdown report</li>
</ul>
</li>
<li>create an <code>R</code> folder to hold function definitions
<ul>
<li>create functions for computing population-level and community-level properties</li>
</ul>
</li>
<li>add the MIT License file (checking with the user first, if running in an interactive session)</li>
<li>add a project README</li>
<li>add a template R script for the analysis</li>
<li>add a template Rmd report that is created as a result of running the above R script</li>
<li>open the project in a new RStudio window (if available)</li>
</ul>
</div>
<div id="running-the-code" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-code" class="anchor"></a>Running the Code</h2>
<p>After creating the new project, the readme will contain further instructions to run the code. We summarize briefly here:</p>
<ol style="list-style-type: decimal">
<li>The compendium exists as an R package and needs to be installed first.</li>
<li>R needs to be restarted.</li>
<li>The analysis script in <code>analysis/pipeline.R</code> can be run to perform the analysis and generate the report.</li>
<li>The compiled report at <code>analysis/report.md</code> can be viewed.</li>
</ol>
<p>For further details about how the code within the template project works, see the below guide to interacting with the datasets, the <code>drake</code> workflow package, and our tools for building reproducible analyses.</p>
</div>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<div id="packaged-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#packaged-datasets" class="anchor"></a>Packaged datasets</h2>
<p>Several datasets are included with this package - these can be loaded individually using these specific functions, and require no additional setup.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/get_cowley_lizards.html">get_cowley_lizards</a></span>()
<span class="fu"><a href="../reference/get_cowley_snakes.html">get_cowley_snakes</a></span>()
<span class="fu"><a href="../reference/get_karoo_data.html">get_karoo_data</a></span>()
<span class="fu"><a href="../reference/get_kruger_data.html">get_kruger_data</a></span>()</pre></body></html></div>
</div>
<div id="configuring-download-locations" class="section level2">
<h2 class="hasAnchor">
<a href="#configuring-download-locations" class="anchor"></a>Configuring download locations:</h2>
<p>Other datasets require downloading. To facilitate this, we include functions to help configure a specific location on disk. To check your current setting:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/get_default_data_path.html">get_default_data_path</a></span>()</pre></body></html></div>
<p>and to configure this setting (and then follow the instructions therein):</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/use_default_data_path.html">use_default_data_path</a></span>(<span class="st">"&lt;path&gt;"</span>)</pre></body></html></div>
</div>
<div id="downloading-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-datasets" class="anchor"></a>Downloading datasets:</h2>
<p>To download individual datasets, call <code><a href="../reference/install_retriever_data.html">install_retriever_data()</a></code> with the name of the dataset:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/install_retriever_data.html">install_retriever_data</a></span>(<span class="st">"veg-plots-sdl"</span>)</pre></body></html></div>
<p>To download all the datasets that are currently supported (i.e. with associated code for importing and formatting):</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/install_retriever_data.html">download_datasets</a></span>()</pre></body></html></div>
</div>
<div id="preprocessing-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-datasets" class="anchor"></a>Preprocessing datasets:</h2>
<p>We tap into several collections of datasets in <strong><code>MATSS</code></strong>, so it is useful to do some preprocessing to split the raw database files into separate datasets. These databases are: * BBS (the North American Breeding Bird Survey) * BioTIME (ecological assemblages from the BioTIME Consortium)</p>
<p><strong>Processing these databases are necessary before loading individual datasets in.</strong></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/prepare_datasets.html">prepare_datasets</a></span>() <span class="co"># wrapper function to prepare all datasets</span>
<span class="co"># prepare_biotime_data()</span>
<span class="co"># prepare_bbs_ts_data()</span></pre></body></html></div>
</div>
</div>
<div id="working-with-drake" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-drake" class="anchor"></a>Working with Drake</h1>
<p>We designed <strong><code>MATSS</code></strong> to build off of the workflow package <strong><code>drake</code></strong> for computational analyses. Thus, it can be helpful to have a general understanding of how to use <strong><code>drake</code></strong>.</p>
<div id="basic-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-workflow" class="anchor"></a>Basic Workflow</h2>
<p>The basic apporach to using <strong><code>drake</code></strong> is:</p>
<ul>
<li>run R code to create a <strong><code>drake</code></strong> plans</li>
<li>call <code><a href="https://docs.ropensci.org/drake/reference/make.html">drake::make()</a></code> to perform the work described in a <strong><code>drake</code></strong> plan</li>
</ul>
</div>
<div id="provided-helper-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#provided-helper-functions" class="anchor"></a>Provided Helper Functions</h2>
<p>We provide several functions to help construct plans:</p>
<ul>
<li>
<code><a href="../reference/build_datasets_plan.html">build_datasets_plan()</a></code> constructs a plan for the datasets, with options to include downloaded datasets</li>
<li>
<code><a href="../reference/build_analyses_plan.html">build_analyses_plan()</a></code> constructs a plan for a set of analyses that applies a method to each dataset. It takes as arguments, a plan for the datasets and a plan for the methods.</li>
<li>
<code><a href="../reference/collect_analyses.html">collect_analyses()</a></code> combines the output objects from a single analysis applied to multiple datasets. This helps to achieve a consistent structure for the results, regardless of what individual analysis functions actually return.</li>
<li>
<code><a href="../reference/analysis_wrapper.html">analysis_wrapper()</a></code> is a function that wraps a method that applies to a single time series (such as calculating the slope of the linear trendline), so that the result can be applied to a dataset (resulting in outputs of the method applied to each individual time series in that dataset).</li>
</ul>
<p>Usage of these functions is demonstrated in the template R script generated from <code><a href="../reference/create_MATSS_compendium.html">create_MATSS_compendium()</a></code>.</p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">drake</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="co"># define the plan</span>
<span class="no">plan</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/drake/reference/drake_plan.html">drake_plan</a></span>(<span class="kw">data_1</span> <span class="kw">=</span> <span class="no">mtcars</span>,
                   <span class="kw">data_2</span> <span class="kw">=</span> <span class="no">iris</span>,
                   <span class="kw">my_model</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">mpg</span> ~ <span class="no">disp</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">data_1</span>),
                   <span class="kw">my_summary</span> <span class="kw">=</span> <span class="no">data_2</span> <span class="kw">%&gt;%</span>
                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">Species</span>) <span class="kw">%&gt;%</span>
                       <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all</a></span>(<span class="no">mean</span>))

<span class="co"># run the plan</span>
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/make.html">make</a></span>(<span class="no">plan</span>)
<span class="co">#&gt; ▶ target data_1</span>
<span class="co">#&gt; ▶ target data_2</span>
<span class="co">#&gt; ▶ target my_model</span>
<span class="co">#&gt; ▶ target my_summary</span>

<span class="co"># check resulting objects</span>
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/readd.html">readd</a></span>(<span class="no">my_model</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = mpg ~ disp, data = data_1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)         disp  </span>
<span class="co">#&gt;    29.59985     -0.04122</span>
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/readd.html">readd</a></span>(<span class="no">my_summary</span>)
<span class="co">#&gt; # A tibble: 3 x 5</span>
<span class="co">#&gt;   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width</span>
<span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 setosa             5.01        3.43         1.46       0.246</span>
<span class="co">#&gt; 2 versicolor         5.94        2.77         4.26       1.33 </span>
<span class="co">#&gt; 3 virginica          6.59        2.97         5.55       2.03</span></pre></body></html></div>
</div>
<div id="running-drake-plans" class="section level3">
<h3 class="hasAnchor">
<a href="#running-drake-plans" class="anchor"></a>Running Drake Plans</h3>
<p>Drake plans are run by calling <code><a href="https://docs.ropensci.org/drake/reference/make.html">make()</a></code>. This does several things. First it checks the <strong>cache</strong> to see if any targets need to be re-built, and then it proceeds to build all the targets, in some order that accounts for the dependencies between targets. (e.g. an analysis target that depends on a dataset target to be processed)</p>
<p>The manual has more information about how <a href="https://ropenscilabs.github.io/drake-manual/storage.html#cache-formats">Drake stores its cache</a> and how <a href="https://ropenscilabs.github.io/drake-manual/triggers.html">Drake decides to rebuild targets</a>.</p>
<p>Note that if there are file inputs, it is important that they are declared explicitly using e.g. <code><a href="https://docs.ropensci.org/drake/reference/file_in.html">file_in()</a></code>, <code><a href="https://docs.ropensci.org/drake/reference/knitr_in.html">knitr_in()</a></code>, and <code><a href="https://docs.ropensci.org/drake/reference/file_out.html">file_out()</a></code>. This enables Drake to check if those files are changed and to rebuild targets that depend on the files if needed. Otherwise Drake will treat them as fixed strings.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">plan</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/drake/reference/drake_plan.html">drake_plan</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"some_data.csv"</span>))
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/make.html">make</a></span>(<span class="no">plan</span>)

<span class="co"># make some changes to `some_data.csv`</span>
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/make.html">make</a></span>(<span class="no">plan</span>) <span class="co"># will NOT rebuild the `data` target</span></pre></body></html></div>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">plan</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/drake/reference/drake_plan.html">drake_plan</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://docs.ropensci.org/drake/reference/file_in.html">file_in</a></span>(<span class="st">"some_data.csv"</span>)))
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/make.html">make</a></span>(<span class="no">plan</span>)

<span class="co"># make some changes to `some_data.csv`</span>
<span class="fu"><a href="https://docs.ropensci.org/drake/reference/make.html">make</a></span>(<span class="no">plan</span>) <span class="co"># will rebuild the `data` target</span></pre></body></html></div>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hao Ye, Ellen Bledsoe, Renata Diaz, S. K. Morgan Ernest, Juniper Simonis, Ethan White, Glenda Yenni.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
